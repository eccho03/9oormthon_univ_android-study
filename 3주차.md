# 11 제트팩 라이브러리
## 11-1 제트팩과 androidx 소개
- `jetpack` : 안드로이드 앱을 개발하는 데 필요한 다양한 라이브러리 모음
  - 대부분 `androidx`로 시작하는 패키지명을 사용
  - 앱 개발하는 데 필요한 권장 architecture 제공, API 레벨의 호환성 문제 해결, 플랫폼 API에서 제공하지 않는 기능들 제공
  - ex) `ViewModel`, `LiveData`, `Room`, `Paging`
  - ex) 툴바를 구현하기 위해서는 플랫폼 API의 `android.widget.toolbar`를 이용해야 하는데, 이게 API 21에서 추가돼서 그 이전 버전에서는 오류가 남. 이때 jetpack의 `androidx.appcomat.widget.Toolbar`를 사용하면 호환성 문제 발생 x
- 플랫폼 API : `ART(Android runtime)`에서 제공하는 안드로이드 앱의 핵심 라이브러리
  - 대부분 `android`나 `java`로 시작하는 패키지명을 사용

## 11-2 appcompat 라이브러리 - API 호환성 해결
- appcompat의 `AppCompatActivity` 클래스를 상속받아 작성함.
- 툴바(`Toolbar`) : 화면 위쪽에 타이틀 문자열이 출력되는 영역을 꾸미기 위한 뷰
- 창(`Window`) : 액티비티가 출력되는 전체 영역
- 콘텐츠 영역 : `setContentView()` 함수가 출력하는 내용이 나오는 부분

- 액션바를 이용하고 싶을 시 `Theme.AppCompat.Light.DarkActionBar`를 상속받아 테마를 선언해주면 됨
- 툴바를 이용하고 싶을 시 액션바의 내용을 툴바에 적용되도록 지정해주면 됨
```Kotlin
setSupportActionBar(binding.toolbar)
```
- Q. 액션바와 툴바의 차이?
  - 액션바를 이용하면 레이아웃 xml 파일에 작성하지 않아도 윈도우가 액션바를 자동으로 출력해줘서 편함. 하지만 툴바는 개발자가 직접 제어할 수 있어 액션바보다 다양한 기능을 제공할 수 있음. -> 거의 대부분 툴바 활용
 
---
### 툴바

- 툴바 색상 설정
  - `colorPrimary` : 툴바와 버튼의 배경색으로 사용
  - `colorAccent` : 스위치가 켬 상황일 때와 같이 활성 모드 상태를 표현함
  - `statusBarColor` : 상태바의 배경색으로 활용
 
- 업 버튼 설정
  - 업 버튼 : 액티비티 화면이 앱의 첫 화면이 아닐 때 이전 화면으로 되돌아가는 기능을 함
  - 되돌아 가야 하는 이전 화면의 액티비티를 등록 (1. 액티비티가 등록되는 매니페스트 파일에 등록하는 방법 2. 액티비티 코드로 등록하는 방법)

  메니페스트 파일에서 `<activity>` 태그에 `parentActivityName` 속성을 등록
  ```xml
  <activity
    android:name=".test1.TwoActivity"
    android:exported="false"
    android:parentActivityName=".MainActivity"/>
  ```
  
  코드에서 툴바에 업 버튼이 나오게 지정해야 함
  ```Kotlin
  supportActionBar?.setDisplayHomeAsUpEnabled(true)
  ```

 만일 업 버튼을 눌렀을 때 이전 화면으로 되돌아가기 전에 특별한 로직을 실행하고 싶거나 아니면 매니페스트 설정 없이 코드에서 이전 화면으로 되돌아 가게 하고 싶을 때 액티비티에 `onSupportNavigateUp()` 함수를 재정의함.

- 메뉴 구성
  - 액티비티에 메뉴를 추가하면 툴바 오른쪽에 오버플로 버튼이 나타남. 사용자가 이 버튼을 누르면 메뉴가 아래로 확장되어 나타남.
  - `onCreateOptionsMenu()`와 `onPrepareOptionsMenu()` 함수를 이용함
    - 공통점 : 액티비티의 메뉴를 구성할 때 자동으로 호출됨.
    - 차이점 : `onCreateOptionsMenu()` : 액티비티가 실행되면서 처음에 한 번만 호출됨.
               -> 정적인 메뉴를 구성 시 사용
               `onPrepareOptionsMenu()` : 액티비티가 실행되면서 한 번 호출된 후 오버플로 메뉴가 나타날 때마다 반복해서 호출됨.
               -> 동적인 메뉴를 구성 시 사용
    -> 대부분 사용자 이벤트를 처리하려고 사용하는 것이므로 정적임. 따라서 `onCreateOptionsMenu()`를 주로 사용함.
      else 는 메뉴 옵션 그외에거 받은거니까 걍 알아서 처리되도록 상속해주는거같음

  - 어차피 정적이니까 메뉴 구성 시 `add()` 외에도 XML로 구성하는 경우가 많음. 이때 `res/menu` 디렉토리에 만듦.
  - `showAsAction` : `never(기본)` - 항상 오버플로 메뉴로 출력 / `ifRoom` - 툴바에 공간이 있으면 액션 아이템, 없으면 오버플로 메뉴 / `always` : 항상 액션 아이템
  - `onCreateOptionsMenu()`에 `menuInflater.inflate(R.menu.menu_main, menu)`를 넣어 적용해줌
  
---
### 액션 뷰
ex) `androidx.appcompat.widget.SearchView`
`activityViewClass` 속성에 이용할 액션 뷰 클래스를 등록하면 됨

Q. 사용자 이벤트를 버튼이 아닌 메뉴로 처리하는 이유?
버튼을 이용해서 사용자 이벤트를 처리해도 되지만, 스마트폰 화면은 보통 작아서 앱의 메인 콘텐츠인 문자열과 이미지만으로도 꽉 차거나 스크롤이 생김. 따라서 화면에 데이터와 상관없는 버튼을 제공한다면 비효율적이게 됨.
  
