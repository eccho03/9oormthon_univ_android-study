# 10 다이얼로그와 알림 이용하기
## 10-1 API 레벨 호환성 고려하기
- `minSdk` : 이것부터 설치 가능 
- `targetSdk` : 이 버전의 API로 앱 개발
=> 따라서 `minSdk` 설정값보다 상위 버전의 API를 사용한다면 compatibility(호환성)를 고려해야 함 -> 이를 위해 안드로이드 API 문서를 참고함

- API 레벨 호환성에 문제가 있는 API를 사용할 때 annotation을 추가해 오류를 해결할 수 있음(`@RequiresApi` 혹은 `@TargetApi`)
  -> 이 annotation은 안드로이드에서 오류를 무시하는 설정일 뿐이며, 앱 실행 시 문제를 막으려면 직접 코드로 처리해야 함.

```Kotlin
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.S) {
  ...
}
```

- `Build.VERSION.SDK_INT` : 앱이 실행되는 기기의 API 레벨'

## 10-2 퍼미션 설정하기
- `permission` : 앱의 특정 기능에 부여하는 접근 권한. 다른 앱이나 안드로이드 시스템에서 보호하는 특정 기능을 이용할 때 퍼미션 사용을 설정해야 함
  - `<permission>` : 기능을 보호하려는 앱의 manifest 파일에 설정
  - `<uses-permission>` : 퍼미션으로 보호된 기능을 사용하려는 앱의 manifest 파일에 설정
 
- `protectionLevel`
  - `normal` : 이 기능을사용하는 앱이 퍼미션 사용설정을 해야 하지만, 사용자에게 권한 허용을 요청하지는 않아도 됨
  - `dangerous` : 퍼미션 사용 설정, 사용자에게도 권한 허용을 요청해야 함
 
- 퍼미션 허용 확인 정책의 변경
  - 기존 (API 1 ~ 22) : manifest 파일에 `<uses-permission>`으로 선언만 하면 보호받는 기능을 앱에서 이용하는 데 문제 x
  - 현재 (API 23 ~  ) : 개발자가 `<uses-permmision>`으로 선언하였더라도, 사용자가 권한 화면에서 이를 거부할 수 있게 됨
    => 사용자가 permission을 거부했는지 확인하고, 거부했으면 다시 permission을 허용해달라고 요청해야 함
```Kotlin
open satic fun checkSelfPermission(
  @NonNull context: Context,
  @NonNull permission: String
): Int
```

사용자가 퍼미션을 거부한 경우
```Kotlin
public final <I, O> ActivityRessultLauncher<I> register
ForActivityResult(
  @NonNull ActivityResultContract<I, O> contract,
  @NonNull ActivityResultCallBack<O> callback)
```

퍼미션 허용 요청 확인
```Kotlin
val requestPermissionLauncher = registerForActivityResult(
  ActivityResultContracts.RequestPermission()
) { isGranted ->
  if (isGranted) {
    Log.d("kkang", "callback, granted..")
  } else {
    Log.d("kkang", "callback, denied..")
  }
}
```

퍼미션 허용 요청 실행
```Kotlin
requestPermissionLauncher.launch("android.permission.ACCESS_FINE_LOCATION")
```
