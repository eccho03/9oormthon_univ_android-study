# 15 서비스 컴포넌트
## 15-1 서비스 이해하기
- 서비스 : 오래 걸리는 작업을 백그라운드에서 처리할 수 있게 해주는 컴포넌트
  - 서비스에 화면을 구현하지 않음
  - 안드로이드의 컴포넌트이므로 생명주기를 시스템에서 관리함

### 서비스 생성과 실행
- 서비스 컴포넌트 생성
```Kotlin
class MyService : Service() {
  override fun onBind(intent: Intent): IBinder? {
    return null
  }
}
```

- 서비스 컴포넌트 등록
```Kotlin
<service
  android:name=".MyService"
  android:enabled="true"
  android:exported="true"></service>
```

- 서비스 실행
  - `startService()`로 실행
  ```Kotlin
  val intent = Intent(this, MyService::class.java)
  startService(intent)
  ```

  암시적 인텐트로 실행
  ```Kotlin
  val intent = Intent("ACTION_OUTER_SERVICE")
  intent.setPackage("com.example.test_outer")
  startService(intent)
  ```

  외부 앱 패키지 공개 상태 지정
  ```Kotlin
  <queries>
    <package android:name="com.example.test_outer" />
  </queries>
  ```

  서비스 종료
  ```Kotlin
  val intent = Intent(this, MyService::class.java)
  stopService(intent)
  ```

  - `bindService()`로 실행
  ServiceConnection 인터페이스 구현
  ```Kotlin
  val connection: ServiceConnection = object : ServiceConnection {
    override fun onServiceConnected(name: ComponentName?, service: IBinder?) { } // bindService() 함수로 서비스를 구동할 때 자동으로 호출됨
    override fun onServiceDisconnected(name: ComponentName?) { } // unbindService() 함수로 서비스를 종료할 때 자동으로 호출됨
  }
  ```

  서비스 실행
  ```Kotlin
  val intent = Intent(this, MyService::class.java)
  bindService(intent, connection, Context.BIND_AUTO_CREATE)
  //    intent 객체 / ServiceConnection 객체 / Int 타입의 flags
  ```
    - `Context.BIND_AUTO_CREATE` : 서비스가 실행 상태가 아니어도 객체를 생성해서 실행
    - 지정하지 않으면 인텐트가 전달돼도 서비스가 실행 상태가 아니면 동작하지 않음

  서비스 종료
  ```Kotlin
  unbindService(connection)
  ```

  
  
  
